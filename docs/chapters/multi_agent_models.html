<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.165">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Math 168: Introduction to Networks - 8&nbsp; Multi-Agent Models</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="../site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="../site_libs/quarto-nav/headroom.min.js"></script>
  <script src="../site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="../">
  <script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="../site_libs/quarto-search/fuse.min.js"></script>
  <script src="../site_libs/quarto-search/quarto-search.js"></script>
  <link href="../chapters/prediction_feedback_loops.html" rel="next">
  <link href="../chapters/agent_based_modeling.html" rel="prev">
  <script src="../site_libs/quarto-html/quarto.js"></script>
  <script src="../site_libs/quarto-html/popper.min.js"></script>
  <script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="../site_libs/quarto-html/anchor.min.js"></script>
  <link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link id="quarto-text-highlighting-styles" href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="../site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "sidebar",
    "copy-button": false,
    "collapse-after": 3,
    "panel-placement": "start",
    "type": "textbox",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body class="floating slimcontent">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-Agent Models</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Math 168: <br><b>Introduction to Networks</b></a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Welcome!</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../syllabus/syllabus.html" class="sidebar-item-text sidebar-link">Syllabus</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/specifications.html" class="sidebar-item-text sidebar-link">Standard Specifications</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/resources.html" class="sidebar-item-text sidebar-link">Health, Wellbeing, and Equity</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="../chapters/intro.html" class="sidebar-item-text sidebar-link">Lecture Notes</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/measurement.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Measuring Networks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/random_graphs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Random Graphs: Erdős–Rényi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/degree_sequences.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Random Graphs: Degree Sequences</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/interlude_research_survey.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interlude: A Rapid Survey of Research Questions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/clustering_community.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Clustering and Community Detection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ranking_centrality.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Network Exploration</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/agent_based_modeling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Agent-Based Modeling on Networks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/multi_agent_models.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-Agent Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/prediction_feedback_loops.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Link Prediction and Feedback Loops</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Appendices</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/additional_resources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Network Science Resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/acknowledgements.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/references.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">References</span></a>
  </div>
</li>
    </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#opinion-dynamics-theory" class="nav-link active" data-scroll-target="#opinion-dynamics-theory"> <span class="header-section-number">8.1</span> Opinion Dynamics: Theory</a>
<ul class="collapse">
<li><a href="#consensus-dynamics" class="nav-link" data-scroll-target="#consensus-dynamics">Consensus Dynamics</a></li>
<li><a href="#bounded-confidence" class="nav-link" data-scroll-target="#bounded-confidence">Bounded Confidence</a></li>
</ul></li>
<li><a href="#agent-based-implementations" class="nav-link" data-scroll-target="#agent-based-implementations"> <span class="header-section-number">8.2</span> Agent-Based Implementations</a>
<ul class="collapse">
<li><a href="#consensus-dynamics-1" class="nav-link" data-scroll-target="#consensus-dynamics-1">Consensus Dynamics</a></li>
<li><a href="#zealot-nodes" class="nav-link" data-scroll-target="#zealot-nodes">Zealot Nodes</a></li>
<li><a href="#bounded-confidence-1" class="nav-link" data-scroll-target="#bounded-confidence-1">Bounded Confidence</a></li>
</ul></li>
<li><a href="#questions-for-opinion-models" class="nav-link" data-scroll-target="#questions-for-opinion-models"> <span class="header-section-number">8.3</span> Questions for Opinion Models</a></li>
<li><a href="#epidemic-modeling" class="nav-link" data-scroll-target="#epidemic-modeling"> <span class="header-section-number">8.4</span> Epidemic Modeling</a>
<ul class="collapse">
<li><a href="#the-sis-model" class="nav-link" data-scroll-target="#the-sis-model">The SIS Model</a></li>
<li><a href="#incorporating-global-policy" class="nav-link" data-scroll-target="#incorporating-global-policy">Incorporating Global Policy</a></li>
</ul></li>
<li><a href="#what-next" class="nav-link" data-scroll-target="#what-next"> <span class="header-section-number">8.5</span> What Next?</a></li>
</ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">
<header id="title-block-header" class="quarto-title-block default">

<div class="quarto-title"><h1 class="title d-none d-lg-block display-7"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-Agent Models</span></h1></div></header>

<p>In this set of lecture notes, we’ll discuss mathematical and computational models of agents interacting on networks. We’ll continue with some of the agent-based modeling techniques that we considered in the previous chapter.</p>
<section id="opinion-dynamics-theory" class="level2 page-columns page-full" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="opinion-dynamics-theory"><span class="header-section-number">8.1</span> Opinion Dynamics: Theory</h2>
<p>Broadly, an <em>opinion dynamics model</em> is a model of agents discussing and updating their opinions on one or more topic. Here we’ll consider the following common setup of opinion dynamics on networks:</p>
<ul>
<li>Each agent lives on a <strong>node in a network</strong> and doesn’t move. So, we can refer to each agent by the node <span class="math inline">\(i\)</span> on which it sets.</li>
<li>Each agent <span class="math inline">\(i\)</span> has an <strong>opinion</strong>, which we call <span class="math inline">\(x_i\)</span>. We can collect the opinions into a vector <span class="math inline">\(\mathbf{x}\)</span>. <em>Continuous-state models</em> take <span class="math inline">\(x_i\)</span> to be in some interval, for example <span class="math inline">\(x_i \in [-1, 1]\)</span>. Here, we would interpret opinions close to <span class="math inline">\(-1\)</span> as being strongly opposed to opinions close to <span class="math inline">\(1\)</span>. On the other hand, an opinion of <span class="math inline">\(-\epsilon\)</span> could be in only “weak disagreement” with an opinion of <span class="math inline">\(+\epsilon\)</span>. Other models choose a discrete opinion space for <span class="math inline">\(x_i\)</span>, for example <span class="math inline">\(x_i \in \{0,1\}\)</span>. In this case, there’s no such thing as weak or strong agreement–you either agree or you don’t.</li>
<li><strong>Time is discrete</strong>, so we can talk about the opinion of a node <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>, time <span class="math inline">\(t+1\)</span>, and so on. We’ll write this as <span class="math inline">\(x_i(t)\)</span>.</li>
<li>A node interacts <strong>only with itself and its neighbors in the network</strong>, and updates its opinion in response to the opinions of its neighbors. This update could be either stochastic or deterministic. It can also be <strong>synchronous</strong> (every node updates at the exact same time) or <strong>asynchronous</strong> (only one node updates at a time).</li>
</ul>
<section id="consensus-dynamics" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="consensus-dynamics">Consensus Dynamics</h3>
<p>For our first model, we are going to consider a <strong>deterministic</strong>, <strong>synchronous</strong> update model with <strong>continuous opinions</strong>.</p>
<div class="page-columns page-full"><p>To simplify notation, let <span class="math inline">\(i \sim j\)</span> if <span class="math inline">\((i,j)\in E\)</span>. Let <span class="math inline">\(\partial i\)</span> be the set <span class="math inline">\(\{j \;|\; j \sim i\}\)</span>, and let <span class="math inline">\(\mathbf{x}_{\partial i}(t)\)</span> be the elements of <span class="math inline">\(\mathbf{x}\)</span> with indices in <span class="math inline">\(\partial i\)</span>. Then, we can write our deterministic, synchronous update as: <span id="eq-dynamics-general"><span class="math display">\[
\mathbf{x}_i(t+1) = F(x_i(t), \mathbf{x}_{\partial i}(t)) \quad \forall i \in N\;.
\qquad(8.1)\]</span></span> In order to fully define our model, we need to specify the update function <span class="math inline">\(F\)</span>. In the <em>DeGroot model</em>,  we set <span class="math inline">\(F\)</span> with the form <span id="eq-degroot-1"><span class="math display">\[
x_i(t+1) = F(x_i(t), \mathbf{x}_{\partial i}(t)) = (1-\alpha)x_i(t) + \alpha \frac{1}{k_i}\sum_{j \sim i} x_j(t)\;.
\qquad(8.2)\]</span></span></p><div class="no-row-height column-margin column-container"><span class="aside"><span class="citation" data-cites="degroot1974reaching">DeGroot (<a href="../appendices/references.html#ref-degroot1974reaching" role="doc-biblioref">1974</a>)</span></span></div></div>
<p>Here, <span class="math inline">\(\alpha \in [0,1]\)</span> is a parameter governing the speed of the dynamics. Intuitively, what’s going on in <a href="#eq-degroot-1">Equation&nbsp;<span>8.2</span></a> is that each node forms its new opinion <span class="math inline">\(x_i(t+1)\)</span> by taking a weighted average of its current opinion <span class="math inline">\(x_i(t)\)</span> with the average of its neighbors, which is <span class="math inline">\(\frac{1}{k_i}\sum_{j \sim i} x_j(t)\)</span>. If <span class="math inline">\(\alpha\)</span> is small, most of the weight is placed on the current opinion, and so the change in each timestep is small. If <span class="math inline">\(\alpha\)</span> is large, then each node places a large weight on the neighbor opinions, and so the change in each timestep can be larger.</p>
<p>We can make some progress in analyzing <a href="#eq-degroot-1">Equation&nbsp;<span>8.2</span></a> by moving a copy of <span class="math inline">\(x_i(t)\)</span> over to the lefthand side: <span class="math display">\[
\begin{aligned}
x_i(t+1) - x_i(t) &amp;= -\alpha x_i(t) + \alpha \frac{1}{k_i}\sum_{j \sim i} x_j(t) \\
&amp;=  \alpha \left(-\frac{k_i}{k_i}x_i(t) + \frac{1}{k_i}\sum_{j \sim i} x_j(t)\right) \\
&amp;= \alpha \frac{1}{k_i}\left[\sum_{j\in N} a_{ij}x_j(t) - k_ix_i(t)\right]\;.
\end{aligned}
\]</span></p>
<div class="page-columns page-full"><p>This entrywise expression has a convenient representation in terms of matrices: <span id="eq-degroot-2"><span class="math display">\[
\mathbf{x}(t+1) - \mathbf{x}(t) = \alpha \mathbf{K}^{-1}\left[\mathbf{A} - \mathbf{K}\right] \mathbf{x}(t) = -\alpha \bar{\mathbf{L}}\mathbf{x}(t)\;,
\qquad(8.3)\]</span></span> where <span class="math inline">\(\bar{\mathbf{L}} = \mathbf{K}^{-1}\mathbf{L} = \mathbf{K}^{-1}(\mathbf{K} - \mathbf{A})\)</span> is the <strong>random-walk normalized Laplacian</strong> matrix. </p><div class="no-row-height column-margin column-container"><span class="aside">In order to ensure that <span class="math inline">\(\mathbf{K}\)</span> is invertible, we need to again assume that every node has degree at least equal to 1.</span></div></div>
<p>Now let’s find out why this model is called “consensus dynamics.” A <strong>stationary state</strong> of our discrete-time dynamical model is a vector <span class="math inline">\(\mathbf{x}^*\)</span> such that <span class="math display">\[
x_i^* = F(x_i^*, \mathbf{x}^*_{\partial i}) \quad \forall i\in N\;.
\]</span> Such a vector has the property that it is unchanged by the dynamics. Stationary states and their generalizations describe long-term properties of dynamical systems like this one. Let’s characterize the stationary states of our system.</p>
<p>While one could try to mess with <a href="#eq-degroot-1">Equation&nbsp;<span>8.2</span></a>, it’s much easier and more rewarding to work with <a href="#eq-degroot-2">Equation&nbsp;<span>8.3</span></a>. This is because, if <span class="math inline">\(\mathbf{x}^*\)</span> is a stationary state of the dynamics, then the righthand side of <a href="#eq-degroot-2">Equation&nbsp;<span>8.3</span></a> is equal to 0. This leaves us with the equation <span class="math display">\[
\bar{\mathbf{L}}\mathbf{x}^* = \mathbf{0}\;.  
\]</span></p>
<p>Since <span class="math inline">\(\mathbf{K}\)</span> is positive definite, we can even simplify this further, to</p>
<p><span class="math display">\[
\mathbf{L}\mathbf{x}^* = \mathbf{0}\;.
\]</span></p>
<p>Remembering the structure of the nullspace of <span class="math inline">\(\mathbf{L}\)</span> gives us our result:</p>
<div class="callout-note callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-consensus" class="theorem">
<p><span class="theorem-title"><strong>Theorem 8.1 (Long-Term Behavior of Consensus Dynamics) </strong></span></p>
<p>Let <span class="math inline">\(\mathbf{x}^*\)</span> be a stationary state of the consensus dynamics <a href="#eq-degroot-2">Equation&nbsp;<span>8.3</span></a>. Then, <span class="math inline">\(\mathbf{x}^*\)</span> is constant on each connected component of the graph.</p>
</div>
</div>
</div>
</div>
<p>This result highlights one of the main limitations of consensus dynamics as a model of how opinions evolve. In the world around us, we observe persistent disagreement in social networks, and indeed, one of the main ways in which we observe this disagreement is when agents who disagree interact. The consensus dynamics model says that this shouldn’t really happen, at least in the long term. For this reason, consensus dynamics is a useful mathematical starting point, but doesn’t necessarily tell us much about opinions in real-world social networks.</p>
</section>
<section id="bounded-confidence" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="bounded-confidence">Bounded Confidence</h3>
<div class="page-columns page-full"><p>One arguably strange feature of consensus dynamics is that the influence of node <span class="math inline">\(j\)</span> on node <span class="math inline">\(i\)</span> increases with <span class="math inline">\(\left|x_i - x_j\right|\)</span>. The more these two nodes disagree, the more influence they have on each other. This might not track with your own experience.</p><div class="no-row-height column-margin column-container"><span class="aside">Are you usually more able to be persuaded by your friends and allies, or by people who disagree with you vehemently?</span></div></div>
<p>The idea of <strong>bounded confidence</strong> is one way to rectify this situation. We’ll study the model of <span class="citation" data-cites="hegselmann2002opinion">Hegselmann and Krause (<a href="../appendices/references.html#ref-hegselmann2002opinion" role="doc-biblioref">2002</a>)</span>. The main idea is in fact very simple: we impose a cutoff in which node <span class="math inline">\(j\)</span> ceases to influence node <span class="math inline">\(i\)</span> if <span class="math inline">\(\left|x_i - x_j\right|\)</span> is too large. Mathematically, this looks like modifying the function <span class="math inline">\(F\)</span> in the following way:</p>
<p><span id="eq-HK"><span class="math display">\[
F(x_i(t), x_{\partial i}(t)) = (1-\alpha)x_i(t) + \alpha \frac{1}{k_i(c)} \sum_{j \in \partial i(c)}x_j(t)\;.
\qquad(8.4)\]</span></span></p>
<p>Here, we’re defining the set <span class="math inline">\(\partial i(c) \triangleq \{j \in N \;:\; j \sim i, \left|x_i - x_j\right|\leq c\}\)</span> and the effective degree <span class="math inline">\(k_i(c) = \left|\partial i(c)\right|\)</span>. In words, we are now saying that <em>only nodes whose opinions are <span class="math inline">\(c\)</span>-close can influence each other.</em> This function <span class="math inline">\(F\)</span> now has two parameters, the rate of opinion change <span class="math inline">\(\alpha\)</span> and the so-called <em>confidence threshold</em> <span class="math inline">\(c\)</span>. When <span class="math inline">\(c\)</span> is large, nodes of relatively different opinions can still influence each other, while when <span class="math inline">\(c\)</span> is small, only nodes that are already in nearly perfect agreement will interact. This is one way to model the idea of <em>echo chambers</em>.</p>
<p>The bounded confidence model is much more difficult to analyze than the consensus dynamics model, and in general it’s not possible to reliably predict the details of the long-term behavior. The best that can be said in general is that:</p>
<ol type="1">
<li>The model does indeed reach a stationary state (rather than, say, a limit cycle).</li>
<li>As <span class="math inline">\(c\)</span> gets smaller, there is greater possibility for multiple fragmented opinion clusters to emerge. The details of what happens, however, depend on the initial condition.</li>
</ol>
<p>For this reason, bounded confidence models are almost always studied primarily through simulations.</p>
</section>
</section>
<section id="agent-based-implementations" class="level2 page-columns page-full" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="agent-based-implementations"><span class="header-section-number">8.2</span> Agent-Based Implementations</h2>
<p>On that note, let’s implement some agent-based simulations for these models. We’ll start with consensus dynamics. As before, we’re going to develop a flexible model framework that will accommodate both consensus dynamics and bounded confidence dynamics. The trick is to allow the model to accept as a parameter the function <span class="math inline">\(F\)</span> that describes how a node updates its opinion in response to its neighbors.</p>
<p>It’s not strictly necessary to use agent-based modeling for these simulations; one could instead choose to implement them using matrix-vector products, e.g. <a href="#eq-degroot-2">Equation&nbsp;<span>8.3</span></a>. A hard cutoff operation can be added to implement bounded confidence. However, we are going to continue with an agent-based approach in order to extend the modeling toolbox that we first introduced in <a href="../chapters/agent_based_modeling.html">the previous chatper</a>.</p>
<section id="consensus-dynamics-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="consensus-dynamics-1">Consensus Dynamics</h3>
<p>As usual, we need to import several items from the Mesa modeling framework. The only new one relative to our <a href="../chapters/agent_based_modeling.html">previous notes</a> is the <code>SimultaneousActivation</code> scheduler, which allows each node to perform its behavior at exactly the same time, as described by our <em>synchronous</em> dynamics.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mesa <span class="im">import</span> Model, Agent                 <span class="co"># core mesa classes</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mesa.space <span class="im">import</span> NetworkGrid             </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mesa.time <span class="im">import</span> SimultaneousActivation           </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mesa.datacollection <span class="im">import</span> DataCollector</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx                         <span class="co"># for the grid</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np                            <span class="co"># computations</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns                         <span class="co"># install the seaborn package in your Python environment if this line doesn't run. </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we’ll define the opinion model class. The overall approach is pretty similar to last time. The main difference is that we are going to place down multiple agents on the graph during the <code>__init__()</code> method of the model.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode" id="cb2"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> OpinionModel(Model):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model setup</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, G, agent_class, x0 <span class="op">=</span> <span class="va">None</span>, beta <span class="op">=</span> <span class="va">None</span>, <span class="op">**</span>kwargs):</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schedule <span class="op">=</span> SimultaneousActivation(<span class="va">self</span>) </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.grid <span class="op">=</span> NetworkGrid(G)            </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> <span class="bu">len</span>(x0) <span class="op">==</span> <span class="bu">len</span>(G.nodes)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        node_list <span class="op">=</span> <span class="bu">list</span>(G.nodes)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># place multiple agents, each with an initial opinion</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x0)):</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>            node <span class="op">=</span> node_list[i]</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            agent <span class="op">=</span> agent_class(node, <span class="va">self</span>, x <span class="op">=</span> x0[i], beta <span class="op">=</span> beta[i], <span class="op">**</span>kwargs)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.grid.place_agent(agent, node)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.schedule.add(agent)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collector <span class="op">=</span> DataCollector(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            agent_reporters <span class="op">=</span> {</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Opinion"</span> : <span class="kw">lambda</span> a: a.x</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schedule.step()</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collector.collect(<span class="va">self</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we’ll implement the first agent class for our model. The <code>OpinionAgent</code> has an instance variable <code>x</code> that stores its opinion. It also has <code>step()</code> method like before that updates its opinion in response to the opinions of its neighbors. For now, we’re going to be very vague about how exactly it does this, wrapping it in a function <code>F</code> as in <a href="#eq-dynamics-general">Equation&nbsp;<span>8.1</span></a>. This function needs to accept the updating node, all its neighbors, and then any parameters we supply as well.</p>
<p>A special requirement of the synchronous scheduler <code>SimultaneousActivation</code> is that we need to separate the computation of the new opinion (in <code>self.step()</code>) from actually updating the new opinion (in a new method called <code>self.advance</code>).</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode" id="cb3"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> OpinionAgent(Agent):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, agent_id, model, x, F, <span class="op">**</span>kwargs):</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(agent_id, model)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x <span class="op">=</span> x</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.kwargs <span class="op">=</span> kwargs</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.F <span class="op">=</span> F</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># find all neighboring nodes</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        neighbor_locs <span class="op">=</span> <span class="va">self</span>.model.grid.get_neighbors(<span class="va">self</span>.pos, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                                                      include_center <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        neighbors <span class="op">=</span> <span class="va">self</span>.model.grid.get_cell_list_contents(neighbor_locs)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># compute (and store) the next update</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x_next <span class="op">=</span> <span class="va">self</span>.F(<span class="va">self</span>, neighbors, <span class="op">**</span><span class="va">self</span>.kwargs)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this method is required by the synchronous scheduler</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this is where each node actually changes its opinion. </span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> advance(<span class="va">self</span>):</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x <span class="op">=</span> <span class="va">self</span>.x_next</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to complete our specification of the model, we now simply need to define the update function <span class="math inline">\(F\)</span>. Here’s how it looks for consensus dynamics:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode" id="cb4"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> F_consensus(center, neighbors, beta <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    neighbor_opinions <span class="op">=</span> [a.x <span class="cf">for</span> a <span class="kw">in</span> neighbors]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(neighbor_opinions) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        neighbor_avg <span class="op">=</span> np.mean(neighbor_opinions)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="dv">1</span><span class="op">-</span>beta)<span class="op">*</span>center.x <span class="op">+</span> beta<span class="op">*</span>neighbor_avg</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> center.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s write one last function to partially automate our simulation and visualization:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode" id="cb5"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> opinion_dynamics_experiment(G, F, x0, beta, <span class="op">**</span>kwargs):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> OpinionModel(G, OpinionAgent, x0 <span class="op">=</span> x0, beta <span class="op">=</span> beta, F <span class="op">=</span> F, <span class="op">**</span>kwargs)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        model.step()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    report <span class="op">=</span> model.collector.get_agent_vars_dataframe().reset_index()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> sns.lineplot(data <span class="op">=</span> report, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                       x <span class="op">=</span> <span class="st">"Step"</span>, </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                       y <span class="op">=</span> <span class="st">"Opinion"</span>, </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                       hue <span class="op">=</span> <span class="st">"AgentID"</span>, </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                       legend <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    plt.gca().set_xscale(<span class="st">"log"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s try it out! We’ll grab a graph, initialize an <code>OpinionModel</code> with a vector of initial conditions, take 1,000 steps, and collect the results in a data frame.</p>
<div class="cell page-columns page-full" data-execution_count="7">
<div class="sourceCode" id="cb6"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.les_miserables_graph()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(G.nodes())</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.sort(<span class="dv">2</span><span class="op">*</span>np.random.rand(n) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>np.ones(n)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>opinion_dynamics_experiment(G, F_consensus, x0, beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="multi_agent_models_files/figure-html/cell-7-output-1.png" class="figure-img" width="609" height="424"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption margin-caption">Evolution of the opinion of each agent in a consensus dynamics model on a connected graph.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As predicted by the theory, we can see the agents converging to consensus.</p>
<p>Suppose, on the other hand, that we were dealing with a disconnected graph. This time, although consensus is reached on each of the two connected components, the opinions reached on each component differ.</p>
<div class="cell page-columns page-full" data-execution_count="8">
<div class="sourceCode" id="cb7"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> nx.disjoint_union(G, G)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n_ <span class="op">=</span> <span class="bu">len</span>(H.nodes())</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.sort(<span class="dv">2</span><span class="op">*</span>np.random.rand(n_) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>np.ones(n_)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>opinion_dynamics_experiment(H, F_consensus, x0, beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="multi_agent_models_files/figure-html/cell-8-output-1.png" class="figure-img" width="609" height="424"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption margin-caption">Evolution of the opinion of each agent in a consensus dynamics model on a graph with two connected components.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As expected, consensus is reached on each of the two connected components, but the connected components themselves don’t have to agree.</p>
</section>
<section id="zealot-nodes" class="level3">
<h3 class="anchored" data-anchor-id="zealot-nodes">Zealot Nodes</h3>
<p>We can perform an experiment with zealot nodes, who never change their opinions, simply by setting <span class="math inline">\(\beta_i = 0\)</span> for some of the nodes <span class="math inline">\(i\)</span>.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode" id="cb8"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.sort(<span class="dv">2</span><span class="op">*</span>np.random.rand(n) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>np.ones(n)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>beta[<span class="dv">2</span>]  <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>beta[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>opinion_dynamics_experiment(G, F_consensus, x0, beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="multi_agent_models_files/figure-html/cell-9-output-1.png" class="" width="609" height="424"></p>
</div>
</div>
<p>This time, no consensus is reached, although the nodes do still tend to group together.</p>
</section>
<section id="bounded-confidence-1" class="level3">
<h3 class="anchored" data-anchor-id="bounded-confidence-1">Bounded Confidence</h3>
<p>Now let’s implement the bounded confidence update. Relative to the consensus dynamics update, there’s just a small change: we need to include in the mean only the nodes which are distance less than <span class="math inline">\(c\)</span> from the central node. If no nodes satisfy this criterion, we stipulate that the central node doesn’t update at all.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode" id="cb9"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> F_bounded_confidence(center, neighbors, beta <span class="op">=</span> <span class="dv">1</span>, c <span class="op">=</span> np.Inf):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    neighbor_opinions <span class="op">=</span> [a.x <span class="cf">for</span> a <span class="kw">in</span> neighbors <span class="cf">if</span> np.<span class="bu">abs</span>(a.x <span class="op">-</span> center.x) <span class="op">&lt;</span> c]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(neighbor_opinions) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        neighbor_avg <span class="op">=</span> np.mean(neighbor_opinions)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="dv">1</span><span class="op">-</span>beta)<span class="op">*</span>center.x <span class="op">+</span> beta<span class="op">*</span>neighbor_avg</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> center.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s try it out! In the run below, we see that consensus is almost reached – just a single node is left out and is no longer able to influence or be influenced by the other nodes.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode" id="cb10"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.sort(<span class="dv">2</span><span class="op">*</span>np.random.rand(n) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>np.ones(n)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>opinion_dynamics_experiment(G, F_bounded_confidence, x0, beta, c <span class="op">=</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="multi_agent_models_files/figure-html/cell-12-output-1.png" class="" width="609" height="426"></p>
</div>
</div>
<p>Unlike in the case of consensus dynamics, the long-term behavior of bounded confidence dynamics is very sensitive to initial conditions. For example, in the following run (same parameters!), we see the emergence of two polarized communities, as well as a few isolated nodes.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode" id="cb11"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> np.sort(<span class="dv">2</span><span class="op">*</span>np.random.rand(n) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>opinion_dynamics_experiment(G, F_bounded_confidence, x0, beta, c <span class="op">=</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="multi_agent_models_files/figure-html/cell-13-output-1.png" class="" width="609" height="424"></p>
</div>
</div>
</section>
</section>
<section id="questions-for-opinion-models" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="questions-for-opinion-models"><span class="header-section-number">8.3</span> Questions for Opinion Models</h2>
<p>There are many more ways to handle opinion models, including stochastic or asynchronous update rules, agent variations, and so on. Some questions that are good to ask:</p>
<ol type="1">
<li>What happens when some agents refuse to change their opinions? These agents are sometimes called <em>zealots</em>, and can model things like the influence of media or politicians in a social network. <span class="citation" data-cites="brooks2020model">(<a href="../appendices/references.html#ref-brooks2020model" role="doc-biblioref">Brooks and Porter 2020</a>)</span></li>
<li>What happens if nodes are allowed to move around a network, or perhaps seek out new friends? <span class="citation" data-cites="zimmermann2004coevolution durrett2012graph">(<a href="../appendices/references.html#ref-zimmermann2004coevolution" role="doc-biblioref">Zimmermann, Eguı́luz, and San Miguel 2004</a>; <a href="../appendices/references.html#ref-durrett2012graph" role="doc-biblioref">Durrett et al. 2012</a>)</span></li>
<li>What happens when opinions are complex and multidimensional? Under what circumstances does polarization still emerge? Can this be used as a model of the formation of political parties? <span class="citation" data-cites="kawakatsu2021interindividual">(<a href="../appendices/references.html#ref-kawakatsu2021interindividual" role="doc-biblioref">Kawakatsu et al. 2021</a>)</span></li>
</ol>
<p>If you are interested in current developments in opinion dynamics and modeling of social systems, a <a href="https://www.pnas.org/doi/10.1073/pnas.2116950118">recent focus issue</a> in the <em>Proceedings of the National Academy of Sciences</em> might be worth checking out.</p>
</section>
<section id="epidemic-modeling" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="epidemic-modeling"><span class="header-section-number">8.4</span> Epidemic Modeling</h2>
<p>In this section, we’ll study a model of <em>epidemic spreading</em> on networks. There are a LOT of different kinds of epidemic models; see Newman Chapter 16 for an extended discussion. We’re not going to focus too much on the mathematical details of these models. Instead, we’ll focus a bit more on the process of coding up a simulation model that reflects certain ideas or assumptions that we’d like to investigate further.</p>
<p>Let’s consider the following scientific question:</p>
<blockquote class="blockquote">
<p>How important is it to get <strong>timely</strong> information about the current status of an epidemic when making policy decisions?</p>
</blockquote>
<p>In order to address this question using models, we need a few different ingredients:</p>
<ol type="1">
<li>A model of the epidemic.</li>
<li>A model of how a decision-maker gathers information and makes policy decisions.</li>
<li>A model of how those policy decisions impact the epidemic spread.</li>
</ol>
<p>Let’s take each of these ideas in turn. We’re going to</p>
<section id="the-sis-model" class="level3">
<h3 class="anchored" data-anchor-id="the-sis-model">The SIS Model</h3>
<p>The SIS model is one of many <em>compartmental</em> models of spreading processes on networks. Unlike the opinion models we studied above, in which each agent’s state is a continuous variable <span class="math inline">\(x_i \in [-1, 1]\)</span>, in compartmental models, each agent can be in one of several <em>discrete</em> states, called compartments. Think of each compartment as a qualitative status. In the SIS model, there are two compartments:</p>
<ul>
<li><strong>Susceptible (S)</strong>: The agent is not currently infected with disease, but you could be in the future.</li>
<li><strong>Infected (I)</strong>: The agent is currently infected with disease, and can spread it to others.</li>
</ul>
<p>Modern compartmental models include many more compartments than this. One can also include compartments for <strong>Immune</strong>, <strong>Infected (pre-symptomatic)</strong>, etc. etc. Unfortunately for us, the model above in which immunity is never guaranteed seems like a more relevant one at the moment.</p>
<p>“SIS” stands for “Susceptible-Infected-Susceptible.” This means that an agent who recovers from an infection is again susceptible. We’ll consider a stochastic SIS model with the following transition rules.</p>
<ol type="1">
<li>If agent <span class="math inline">\(i\)</span> is currently <em>Susceptible</em>, then for each <em>Infected</em> neighbor of <span class="math inline">\(i\)</span>, agent <span class="math inline">\(i\)</span> flips a coin with probability of heads <span class="math inline">\(\beta\)</span>. If any of these coins come up heads, then <span class="math inline">\(i\)</span> also becomes <em>Infected</em>.</li>
<li>Additionally, if agent <span class="math inline">\(i\)</span> is currently <em>Susceptible</em>, then they also flip a coin with probability of heads <span class="math inline">\(\beta_\mathrm{background}\)</span>, and become <em>Infected</em> if <em>this</em> coin comes up heads. The background infection rate models contacts with people outside the network data.</li>
<li>If <span class="math inline">\(i\)</span> is currently <em>Infected</em>, then <span class="math inline">\(i\)</span> flips a coin with probability of heads <span class="math inline">\(\gamma\)</span>. If this coin comes up heads, then <span class="math inline">\(i\)</span> recovers and is now <em>Susceptible</em> again.</li>
</ol>
<p>This is already a complete model that we can code up. In fact, our <code>CompartmentalModel</code> and <code>CompartmentalAgent</code> are <em>very</em> similar to our opinion model from the previous section.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode" id="cb12"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CompartmentalModel(Model):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model setup</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, G, agent_class, p_infected <span class="op">=</span> <span class="dv">0</span>, beta <span class="op">=</span> <span class="dv">0</span>, beta_background <span class="op">=</span> <span class="dv">0</span>, <span class="op">**</span>kwargs):</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schedule <span class="op">=</span> SimultaneousActivation(<span class="va">self</span>) </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.grid <span class="op">=</span> NetworkGrid(G)            </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.beta <span class="op">=</span> beta</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.beta_background <span class="op">=</span> beta_background</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        node_list <span class="op">=</span> <span class="bu">list</span>(G.nodes)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># place multiple agents, each with an initial opinion</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(node_list)):</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>            node <span class="op">=</span> node_list[i]</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> <span class="st">"I"</span> <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> p_infected <span class="cf">else</span> <span class="st">"S"</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>            agent <span class="op">=</span> agent_class(node, <span class="va">self</span>, state, <span class="op">**</span>kwargs)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.grid.place_agent(agent, node)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.schedule.add(agent)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collector <span class="op">=</span> DataCollector(</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>            agent_reporters <span class="op">=</span> {</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">"State"</span> : <span class="kw">lambda</span> a: a.state</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schedule.step()</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collector.collect(<span class="va">self</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our <code>CompartmentalAgent</code> class also has a very similar structure:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode" id="cb13"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CompartmentalAgent(Agent):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, agent_id, model, state, F, <span class="op">**</span>kwargs):</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(agent_id, model)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.state <span class="op">=</span> state</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.F <span class="op">=</span> F</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.kwargs <span class="op">=</span> kwargs</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        neighbor_locs <span class="op">=</span> <span class="va">self</span>.model.grid.get_neighbors(<span class="va">self</span>.pos, </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                                                      include_center <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        neighbors <span class="op">=</span> <span class="va">self</span>.model.grid.get_cell_list_contents(neighbor_locs)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.state_next <span class="op">=</span> <span class="va">self</span>.F(<span class="va">self</span>, neighbors, <span class="va">self</span>.model.beta, <span class="va">self</span>.model.beta_background, <span class="op">**</span><span class="va">self</span>.kwargs)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> advance(<span class="va">self</span>):</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.state <span class="op">=</span> <span class="va">self</span>.state_next</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode" id="cb14"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> F_SIS(center, neighbors, beta <span class="op">=</span> <span class="fl">0.01</span>, beta_background <span class="op">=</span> <span class="fl">0.0001</span>, gamma <span class="op">=</span> <span class="fl">0.1</span>):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> center.state <span class="op">==</span> <span class="st">"S"</span>:</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> beta_background: </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"I"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        num_infected_neighbors <span class="op">=</span> <span class="bu">sum</span>([a.state <span class="op">==</span> <span class="st">"I"</span> <span class="cf">for</span> a <span class="kw">in</span> neighbors])</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">sum</span>(np.random.rand(num_infected_neighbors) <span class="op">&lt;</span> beta) <span class="op">&gt;=</span> <span class="dv">1</span>:</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"I"</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"S"</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> center.state <span class="op">==</span> <span class="st">"I"</span>:</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> gamma:</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"S"</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"I"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode" id="cb15"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.les_miserables_graph()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> CompartmentalModel(G, CompartmentalAgent, p_infected <span class="op">=</span> <span class="fl">0.01</span>,  F <span class="op">=</span> F_SIS, beta <span class="op">=</span> <span class="fl">0.01</span>, beta_background <span class="op">=</span> <span class="fl">0.001</span>, gamma <span class="op">=</span> <span class="fl">0.1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    model.step()</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>report <span class="op">=</span> model.collector.get_agent_vars_dataframe().reset_index()</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>report[<span class="st">"is_I"</span>] <span class="op">=</span> report[<span class="st">"State"</span>] <span class="op">==</span> <span class="st">"I"</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>percentages <span class="op">=</span> report.groupby(<span class="st">"Step"</span>)[<span class="st">"is_I"</span>].mean()</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.plot(percentages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="multi_agent_models_files/figure-html/cell-17-output-1.png" class="" width="579" height="404"></p>
</div>
</div>
<p>This already doesn’t look like such a qualitatively bad model; we can see that it produces <em>waves</em> of epidemic.</p>
</section>
<section id="incorporating-global-policy" class="level3">
<h3 class="anchored" data-anchor-id="incorporating-global-policy">Incorporating Global Policy</h3>
<p>Suppose now that we consider a decision-maker with the ability to reduce the rate of transmission through measures such as mask mandates, shelter-in-place orders, or similar measures. We’re going to model this as saying that the decision-maker has the ability to control the transmission rate <span class="math inline">\(\beta\)</span>. We’re going to assume that they impose mitigation measures when they observe a rate of infection above a certain point, and remove these mitigation measures when they observe a rate of infection below a certain point. However, we’re going to assume that their information is <em>lagged</em>: their most recent data is actually <span class="math inline">\(k\)</span> days in the past. We’re going to study what the impact of <span class="math inline">\(k\)</span> is.</p>
<p>The way we implement this behavior in code is by having the model <em>change</em> <span class="math inline">\(\beta\)</span> when it observes the (lagged) data telling it that this is possible. This requires only that we (a) store the possible values of <span class="math inline">\(\beta\)</span> as instance variables and (b) that we add some additional behavior to the model’s <code>step()</code> method to toggle between the two of them.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode" id="cb16"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CompartmentalModel(Model):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model setup</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, G, agent_class, p_infected <span class="op">=</span> <span class="dv">0</span>, beta_background <span class="op">=</span> <span class="dv">0</span>, beta_low <span class="op">=</span> <span class="dv">0</span>, beta_high <span class="op">=</span> <span class="dv">1</span>, threshold <span class="op">=</span> <span class="fl">0.2</span>, lag <span class="op">=</span> <span class="dv">0</span>, <span class="op">**</span>kwargs):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schedule <span class="op">=</span> SimultaneousActivation(<span class="va">self</span>) </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.grid <span class="op">=</span> NetworkGrid(G)            </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.beta <span class="op">=</span> beta_high</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.beta_low <span class="op">=</span> beta_low</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.beta_high <span class="op">=</span> beta_high</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.beta_background <span class="op">=</span> beta_background</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.threshold <span class="op">=</span> threshold</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lag <span class="op">=</span> lag</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.history <span class="op">=</span> []</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        node_list <span class="op">=</span> <span class="bu">list</span>(G.nodes)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># place multiple agents, each with an initial opinion</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(node_list)):</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>            node <span class="op">=</span> node_list[i]</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> <span class="st">"I"</span> <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> p_infected <span class="cf">else</span> <span class="st">"S"</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>            agent <span class="op">=</span> agent_class(node, <span class="va">self</span>, state, <span class="op">**</span>kwargs)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.grid.place_agent(agent, node)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.schedule.add(agent)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collector <span class="op">=</span> DataCollector(</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>            agent_reporters <span class="op">=</span> {</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">"State"</span> : <span class="kw">lambda</span> a: a.state</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schedule.step()</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collector.collect(<span class="va">self</span>)</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        percentage_I <span class="op">=</span> np.mean([a.state <span class="op">==</span> <span class="st">"I"</span> <span class="cf">for</span> a <span class="kw">in</span> <span class="va">self</span>.schedule.agents])</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.history.append(percentage_I)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.history) <span class="op">&gt;</span> <span class="va">self</span>.lag:</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.history[<span class="op">-</span>(<span class="va">self</span>.lag<span class="op">+</span><span class="dv">1</span>)] <span class="op">&gt;</span> <span class="va">self</span>.threshold:</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.beta <span class="op">=</span> <span class="va">self</span>.beta_low </span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.beta <span class="op">=</span> <span class="va">self</span>.beta_high</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because we implemented our <code>Agent</code> class to work with the model’s value of <span class="math inline">\(\beta\)</span>, we don’t actually need to make any more changes to our agents: we are ready for experiments!</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode" id="cb17"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> experiment(lag):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> nx.les_miserables_graph()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> CompartmentalModel(G, CompartmentalAgent, p_infected <span class="op">=</span> <span class="fl">0.01</span>,  F <span class="op">=</span> F_SIS, beta_low <span class="op">=</span> <span class="fl">0.01</span>, beta_high <span class="op">=</span> <span class="fl">0.03</span>, beta_background <span class="op">=</span> <span class="fl">0.001</span>, gamma <span class="op">=</span> <span class="fl">0.1</span>, threshold <span class="op">=</span> <span class="fl">0.05</span>, lag <span class="op">=</span> lag)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>):</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        model.step()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    report <span class="op">=</span> model.collector.get_agent_vars_dataframe().reset_index()</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    report[<span class="st">"is_I"</span>] <span class="op">=</span> report[<span class="st">"State"</span>] <span class="op">==</span> <span class="st">"I"</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    percentages <span class="op">=</span> report.groupby(<span class="st">"Step"</span>)[<span class="st">"is_I"</span>].mean()</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(percentages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s visualize the progress of 5 different simulations, with different values of the lag.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode" id="cb18"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fig, axarr <span class="op">=</span> plt.subplots(<span class="dv">5</span>, figsize <span class="op">=</span> (<span class="dv">5</span>, <span class="dv">8</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>lags <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    percentages <span class="op">=</span> experiment(lags[i])</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    axarr[i].plot([<span class="dv">0</span>, <span class="dv">500</span>], [<span class="fl">0.05</span>, <span class="fl">0.05</span>], color <span class="op">=</span> <span class="st">"grey"</span>, zorder <span class="op">=</span> <span class="op">-</span><span class="dv">10</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    axarr[i].plot(percentages) </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    axarr[i].set_ylim([<span class="dv">0</span>, <span class="fl">.5</span>])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    mean_perc <span class="op">=</span> np.<span class="bu">round</span>(<span class="dv">100</span><span class="op">*</span>np.mean(percentages), <span class="dv">1</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    axarr[i].<span class="bu">set</span>(title <span class="op">=</span> <span class="ss">f"Lag: </span><span class="sc">{</span>lags[i]<span class="sc">}</span><span class="ss"> days, mean infection level = </span><span class="sc">{</span>mean_perc<span class="sc">}</span><span class="ss">%"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    axarr[i].<span class="bu">set</span>(ylabel <span class="op">=</span> <span class="st">"% Infected"</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="multi_agent_models_files/figure-html/cell-21-output-1.png" class="" width="469" height="757"></p>
</div>
</div>
<p>When the lag is small, it is possible for the global policy to keep the infection level relatively close to the threshold at 5%. However, when the lag is much larger, the same decision-making criterion leads to dramatically more infections–almost 15% in some of these simulations.</p>
</section>
</section>
<section id="what-next" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="what-next"><span class="header-section-number">8.5</span> What Next?</h2>
<p>It’s important not to overinterpret simulation results like the above. The SIS model that we’ve implemented here is an interesting <em>qualitative</em> model with some realistic behaviors. However, it’s far too simple a model to be used to make quantitative predictions about the spread of real diseases. Epidemiological models that aim to do accurate disease forecasting need to take into account questions like:</p>
<ol type="1">
<li>What <em>actually</em> is the network on which disease spreads? Is it your social network? Do the people you sat next to on the bus count? Do different kinds of contacts carry different levels of transmission risk? How do we account for the fact that your contacts can vary from day to day?</li>
<li>What are the right compartments for modeling? Most diseases aren’t just “on our off.” Other important compartments include “infectious asymptomatic,” “infectious symptomatic,” “partially protected,” etc. etc. More complicated models describing how agents transition from one of these states to the other are needed for accurate forecasting, and estimating the rates (like <span class="math inline">\(\beta\)</span>) is a challenging statistical task.</li>
<li>How do decisions get made, communicated, and implemented in the network? Decision-makers don’t actually have the ability to magically change everyone’s behavior instantaneously, and the measures to which they do have access often come with costs (financial, political).</li>
</ol>
<p>So, it’s important to be careful when interpreting these models for use in the real world. In the model that we just discussed, I would describe our finding as:</p>
<blockquote class="blockquote">
<p>Decision-making based on timely data can significantly reduce overall infection levels.</p>
</blockquote>
<p>However, I’d hesitate to be more specific than that, and I wouldn’t lean too heavily on the quantitative details.</p>



</section>
</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/agent_based_modeling.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Agent-Based Modeling on Networks</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/prediction_feedback_loops.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Link Prediction and Feedback Loops</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->


</body></html>